{% load static %}
{% verbatim %}
<div class="row">
    <div class="col mt-3">
        <h3>{{ modelInstance.verbose_name }}</h3>
        <p>{{ modelInstance.description }}</p>
    </div>
</div>
<div class="row">

    <div class="col-12 col-md-6 col-lg-4">
        <h4>Исходные данные</h4>
        <div class="mb-3">
            <label for="" class="form-label">Таблица "Отбор от НИЗ / Обводнённость"
                <i class="bi bi-question-circle" data-bs-toggle="tooltip" data-bs-placement="right"
                   title="Введите таблицу из трех столбцов: Дата, Отбор от НИЗ, Обводнённость. Нажмите кнопку редактирования для ввода значений"></i></label>
            <niz-table-editor table="modelInstance.input_data.niz_table" is-invalid="validationErrors.niz_table" ng-class="{'is-invalid': validationErrors.niz_table}"></niz-table-editor>
            <div class="invalid-feedback" ng-if="validationErrors.niz_table">
                {{validationErrors.niz_table}}
            </div>
        </div>
        <div class="mb-3">
            <label for="id_total" class="form-label">Величина геологических запасов, м<sup>3</sup></label>
            <input type="number" class="form-control" id="id_total" step="0.000000000000001" ng-model="modelInstance.input_data.total" ng-class="{'is-invalid': validationErrors.total}">
            <div class="invalid-feedback" ng-if="validationErrors.total">
                {{validationErrors.total}}
            </div>
        </div>
        <div class="mb-3">
            <label for="id_kin" class="form-label">Коэффициент извлечения нефти, д.ед.</label>
            <input type="number" step="0.000000000000001" min="0" max="1" class="form-control" id="id_kin" aria-describedby="kinHelp" ng-model="modelInstance.input_data.kin" ng-class="{'is-invalid': validationErrors.kin}">
            <div id="kinHelp" class="form-text">Введите значение в диапазоне от 0.000 до 1.000</div>
            <div class="invalid-feedback" ng-if="validationErrors.kin">
                {{validationErrors.kin}}
            </div>
        </div>
        <div class="mb-3">
            <label for="id_debit" class="form-label">Дебит жидкости, м<sup>3</sup>/сут</label>
            <input type="number" step="1" class="form-control" id="id_debit" ng-model="modelInstance.input_data.debit" ng-class="{'is-invalid': validationErrors.debit}">
            <div class="invalid-feedback" ng-if="validationErrors.debit">
                {{validationErrors.debit}}
            </div>
        </div>
        <div class="mb-3">
            <label for="" class="form-label">Референтные модели
                <i class="bi bi-question-circle" data-bs-toggle="tooltip" data-bs-placement="right"
                   title="Вы можете добавить до трёх референтных моделей. Для каждой модели введите таблицу, состоящую из столбца с объемом добычи. Нажмите на кнопку добавить для добавления новой модели"></i>
            </label>
            <referent-model-table-editor referent-models="modelInstance.input_data.referent_models"></referent-model-table-editor>
        </div>
        <div class="mb-3">
            <button class="form-control btn btn-primary" id="" ng-click="calculate()" ng-disabled="isProcessing" ng-class="{'is-invalid': validationErrors.bad_request_reason}">
                <span ng-if="isProcessing"><span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span> Операция выполняется</span>
                <span ng-if="!isProcessing">Произвести моделирование</span>
            </button>
            <div class="invalid-feedback" ng-if="validationErrors.bad_request_reason">
                {{validationErrors.bad_request_reason}}
            </div>
        </div>
    </div>
    <div class="col-12 col-md-6 col-lg-8" ng-if="modelInstance.output_data.production_table">
        <h4>Результат</h4>
        <chart-viewer series="chartSeries"></chart-viewer>
        <div class="row mb-3 mt-1">
            <div class="col">
                Начальные извлекаемые запасы (НИЗ), м<sup>3</sup>: <strong>{{ modelInstance.output_data.niz | number:2 }}</strong>
            </div>
        </div>
        <div class="row">
            <div class="col">
                Таблица "Добыча в месяц / дебит в сутки"
                <button type="button" class="btn btn-sm" id="copyResultTableButton" ngclipboard data-clipboard-target="#resultTable" ngclipboard-success="onCopyToClipboardSuccess(e)" ngclipboard-error="onCopyToClipboardError(e)">
                    <i class="bi bi-clipboard" ng-if="!copyToClipboardButtonsState.copyResultTableButton"></i>
                    <i class="bi bi-clipboard-check" ng-if="copyToClipboardButtonsState.copyResultTableButton"></i>
                </button>
                <table class="table table-striped table-bordered table-hover table-sm" id="resultTable">
                    <thead>
                    <tr>
                        <th>Дата</th>
                        <th>Добыча в месяц, м<sup>3</sup></th>
                        <th>Дебит в сутки, м<sup>3</sup></th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr ng-repeat="row in modelInstance.output_data.production_table">
                        <td>{{ row[0] | date:'dd.MM.yy' }}</td>
                        <td>{{ row[1] | roundTo:2 }}</td>
                        <td>{{ row[2] | roundTo:2 }}</td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>
</div>
{% endverbatim %}